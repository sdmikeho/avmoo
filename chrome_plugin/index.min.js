"use strict";$(document).ready(function(){function e(e){var t="",a={number:m,title:r,cover:b,mark:v,time:x,label:w,actor:O};if("like"==e)t="like",a.like=!0;else{if("pity"!=e)return!1;t="pity",a.pity=!0}$.ajax({url:f+"/hide/avmoo/add",method:"POST",data:a}).done(function(e){1==e.code||-5==e.code?($("#cancel").show(),$("#cancel").text("cancel "+t),$("#like").hide(),$("#pity").hide()):alert("operate error")}).fail(function(e){console.log(e),alert("ajax error")})}function t(e){var t={mark:v};$.ajax({url:f+"/hide/avmoo/del",method:"POST",data:t}).done(function(e){1==e.code?($("#cancel").hide(),$("#like").show(),$("#pity").show()):alert("operate error")}).fail(function(e){console.log(e),alert("ajax error")})}for(var a=$(".container h3").clone(),n=a.text().split(" "),i="",l=1;l<n.length;++l)i+=n[l]+" ";var r=i,o=null;o=$("#sample-waterfall").length>0?$("#sample-waterfall"):$("#avatar-waterfall").length>0?$("#avatar-waterfall"):$("#movie-share");var c=$("#sample-waterfall").find(".sample-box");c&&c.length>0&&(o.append('<div id="waterfall" > </div>'),$.each(c,function(){var e=$(this).attr("href"),t=new Image;t.src=e,t=$(t),t.attr("alt","loading"),t.css("width","39%"),t.css("border","1px solid white"),t.css("margin","2px"),$("#waterfall").append(t),$(this).remove()}));var d=$(".genre"),s=["合集","女優ベスト・総集編","VR専用"],h=!1;d.length>0&&$.each(d,function(){var e=$(this).find("a").text().trim();if(s.indexOf(e)>-1)return void(h=!0)}),h?($("h3").css("border","3px darkgray dashed"),$("h3").css("padding","5px"),$("h3").css("background-color","#a9a9a994")):($("h3").css("border","3px green dashed"),$("h3").css("padding","5px"),$("h3").css("background-color","#0080003d"));var p=$(".hidden-xs").find("a").attr("href");console.log("outer_link",p),o.append(a),o.append('<iframe security="restricted" sandbox="allow-scripts allow-same-origin allow-popups" style="\n        width: 75%; \n        height: 1820px;\n    " src="'+p+'" name="frame" id="frame"></iframe>');var f="http://localhost:3333";o.append('<div style="\n    box-shadow: 1px 1px 2px 1px;\n    padding:10px;\n    position: fixed;\n    left: 88%;\n    top: 63%;\n  " id="myOperator" ></div>'),$("#myOperator").html('\n    <button style="display: none" id="cancel" class="btn btn-default btn-lg" type="button">\n                        cancel\n                    </button>\n                    <hr/>\n      <button id="like" class="btn btn-danger btn-lg" type="button">\n          <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Like it !\n      </button>\n      <a class="btn-md" id="like_number" target="_blank" href="'+f+'/hide/avmoo/like_archived">like_archived\n          <span id="like_count_badge" class="badge"></span>\n      </a>\n      <br/>\n      <br/>\n      <button id="pity" class="btn btn-warning btn-lg" type="button">\n          <span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span> Pity it !\n      </button>\n      <a class="btn-md" id="pity_number" target="_blank" href="'+f+'/hide/avmoo/pity_archived">pity_archived\n          <span id="pity_count_badge" class="badge"></span>\n      </a>\n  ');var u=$("#isLikeOrIsPity").val();u&&($("#cancel").show(),$("#cancel").text("cancel "+u),$("#like").hide(),$("#pity").hide()),$("#like").click(function(){e("like")}),$("#pity").click(function(){e("pity")}),$("#cancel").click(function(){t("like")});var g=window.location.href.split("/"),m=g[g.length-1],b=$(".screencap").children("a").attr("href"),y=$(".info").children().first().children().last().text().trim(),v=y,k=$(".info").children().eq(1).text().trim(),x=k,_=[];$(".info").children().last().children().each(function(e,t){_.push($(this).find("a").text().trim())});var w=_.join(" "),j=[];$("#avatar-waterfall").children("a").each(function(e,t){var a={};a.link=$(this).attr("href").trim(),a.name=$(this).find("span").text().trim(),a.icon=$(this).find("img").attr("src").trim(),j.push(a.name)});var O=j.join(" "),u=!1;console.log("number_hide",m),console.log("title_hide",r),console.log("cover_hide",b),console.log("mark_hide",v),console.log("time_hide",x),console.log("label_hide",w),console.log("actor_hide",O),$.ajax({url:f+"/hide/avmoo/get?mark="+v,method:"GET"}).done(function(e){0==e.code?(u=e.isLikeOrIsPity,console.log("isLikeOrIsPity",u),u&&($("#cancel").show(),$("#cancel").text("cancel "+u),$("#like").hide(),$("#pity").hide()),$("#like_count_badge").text(e.like_count),$("#pity_count_badge").text(e.pity_count)):alert("get status by mark error")}).fail(function(e){console.log(e),alert("ajax error")}),console.log("number_hide:"+m)});